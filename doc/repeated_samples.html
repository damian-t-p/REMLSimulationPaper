<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Figures for large-p simulations</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Figures for large-p simulations</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(REMLSimulationPaper)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  tidyverse,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  MASS</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load_gh</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;dpavlyshyn/halfsibdesign&quot;</span> <span class="co"># Simulate and fit balanced half-sib designs</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a global theme for all figures in the document</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code></pre></div>
<div id="figures-1-and-2-stepwise--and-pairwise-reml-estimates" class="section level1">
<h1>Figures 1 and 2: stepwise- and pairwise-REML estimates</h1>
<p>We use the parameters described in eqs. (3, 5):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># number of traits</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of sires</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># number of dams</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># number of individuals per line</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">2</span>, p) <span class="co"># Just a vector of 2s - not really important for the model</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(p))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(p))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)</span></code></pre></div>
<p>As before, we generate our half-sib data and compute the pseudo-REML
estimates, logging the eigenvalues of the corresponding estimate <span class="math inline">\(\hat{\Sigma}_A\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rhalfsib</span>(mu, A, I, B, J, E, K)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>A_reml_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>eigs_reml_est <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A_reml_est<span class="sc">$</span>S3, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span></code></pre></div>
<div id="figure-1-eigenvalue-histograms" class="section level2">
<h2>Figure 1: eigenvalue histograms</h2>
<p>We then plot the eigenvalues of <span class="math inline">\(\hat{\Sigma}_A\)</span> (in red) next to the true
eigenvalues of <span class="math inline">\(\Sigma_A\)</span> (in
blue):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>estimate_names <span class="ot">=</span> <span class="fu">expression</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="st">&quot;REML estimate&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">True =</span> <span class="st">&quot;True&quot;</span><span class="sc">~</span>Sigma[A]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>eig_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> eigs_reml_est,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">True =</span> sigma_a</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(REML, True), <span class="at">names_to =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Eigenvalue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="fu">factor</span>(Type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;REML&quot;</span>)))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(eig_df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Eigenvalue, <span class="at">fill =</span> Type)) <span class="sc">+</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> doc_colours[[<span class="dv">1</span>]]) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>Type,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(estimate_names[<span class="fu">as.character</span>(Type)]))) <span class="sc">+</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Count&quot;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/first-REML.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-2-stepwise-reml-and-pseudo-reml-scatterplot" class="section level2">
<h2>Figure 2: Stepwise REML and Pseudo REML scatterplot</h2>
<p>Last, we investigate the strategy of computing pairwise REML
estimates for each pair of traits. We create a new estimate <span class="math inline">\(\hat{\Sigma}_{A,2}\)</span> such that the diagonal
entries <span class="math inline">\([\hat{\Sigma}_{A,2}]_{ii}\)</span>
are computed by doing a single-trait analysis on trait <span class="math inline">\(i\)</span> and the off-diagonal entries <span class="math inline">\([\hat{\Sigma}_{A,2}]_{ij}\)</span> are computed by
doing a 2-trait analysis on the traits <span class="math inline">\((i,j)\)</span>.</p>
<p>I use the pseudo-REML estimates for the 2-trait analyses, since we
need to fill in 1250 entries of a covariance matrix, and even in the
2-dimensional case, fitting a generic mixed model is too slow for this.
However, we can still compare <span class="math inline">\(\hat{\Sigma}_{A,2}\)</span> with the REML esimate
<span class="math inline">\(\hat{\Sigma}_{A,1}\)</span> to see how the
eigenvalues produced by the paiwiise procedure differ from those done by
computing the whole stepwise REML estimate at once.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>A_pairwise_est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> p, <span class="at">ncol =</span> p)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill in diagonal</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  df_sub <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, trait <span class="sc">==</span> r)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  A_sub_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df_sub)<span class="sc">$</span>S3</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  A_pairwise_est[r, r] <span class="ot">&lt;-</span> A_sub_est[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(r <span class="sc">&lt;</span> q) {</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(s <span class="cf">in</span> (r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>p) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      df_sub <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, trait <span class="sc">%in%</span> <span class="fu">c</span>(r, s))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      A_sub_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df_sub)<span class="sc">$</span>S3</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      A_pairwise_est[r, s] <span class="ot">&lt;-</span> A_sub_est[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      A_pairwise_est[s, r] <span class="ot">&lt;-</span> A_pairwise_est[r, s]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  A_pairwise_est,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;../data/pairwise-covariances.csv&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Plotting these eigenvalues, we see that the eigenvalues of <span class="math inline">\(A_2\)</span> are qualitatively similar to those of
<span class="math inline">\(A_1\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>eigs_pairwise_est <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A_pairwise_est, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span></code></pre></div>
<p>To make this comparison clearer, let <span class="math inline">\(\lambda_1 &gt; \dotsc &gt; \lambda_q\)</span> the
the eigenvalues of <span class="math inline">\(A_1\)</span> and <span class="math inline">\(\mu_1 &gt; \dotsc &gt; \mu_q\)</span> be the
eigenvalues of <span class="math inline">\(A_2\)</span>.</p>
<p>In the following figure, we plot <span class="math inline">\(\mu_i -
\lambda_i\)</span> against <span class="math inline">\(\lambda_i\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> eigs_reml_est, <span class="at">y =</span> eigs_pairwise_est <span class="sc">-</span> eigs_reml_est)) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">&quot;Eigenvalues&quot;</span><span class="sc">~</span>lambda[<span class="st">&quot;i, R&quot;</span>]<span class="sc">~</span><span class="st">&quot;of&quot;</span><span class="sc">~</span>Sigma[<span class="st">&quot;A,R&quot;</span>]),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(lambda[<span class="st">&quot;i, P&quot;</span>] <span class="sc">-</span> lambda[<span class="st">&quot;i, R&quot;</span>])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/eval-diffs.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="figures-3-and-4-repeated-samples" class="section level1">
<h1>Figures 3 and 4: repeated samples</h1>
<p>We set up a function to perform repeated samples</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>repeated_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(p_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output data frame</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fu">integer</span>(),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rep =</span> <span class="fu">integer</span>(),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fu">character</span>(),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_idx =</span> <span class="fu">integer</span>(),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">character</span>(),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_eig =</span> <span class="fu">numeric</span>(),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_eig =</span> <span class="fu">numeric</span>()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(p <span class="cf">in</span> p_vals) {</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">A</span>(p)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">B</span>(p)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    E <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">E</span>(p)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    mu_vec <span class="ot">&lt;-</span> <span class="fu">make_mu</span>(p)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(rep <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_reps) {</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> <span class="fu">rhalfsib</span>(mu_vec, A, I, B, J, E, K)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(method <span class="cf">in</span> <span class="fu">names</span>(methods)) {</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        reml_est <span class="ot">&lt;-</span> methods[[method]](df)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">#reml_est &lt;- manova_2way_df(df)</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        A_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S3, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        df_A <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> p,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_a<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> A_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        B_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S2, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>        df_B <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> p,</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_b<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> B_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>        E_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S1, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>        df_E <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> p,</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;E&quot;</span>,</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_e<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> E_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>        res_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(res_df, df_A, df_B, df_E)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res_df)</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="figure-3-bias-in-large-eigenvalues" class="section level2">
<h2>Figure 3: bias in large eigenvalues</h2>
<p>We use the parameter values specified in eq. (6):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>max_idx <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">MANOVA =</span> manova_2way_df,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> stepreml_2way_df</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># model parameters</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>make_sigmas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> <span class="cf">function</span>(p) {sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)},</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="cf">function</span>(p) {sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)},</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> <span class="cf">function</span>(p) {sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)}</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>make_mu <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {<span class="fu">rep</span>(mu, p)}</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>res_df <span class="ot">&lt;-</span> <span class="fu">repeated_sample</span>(p_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(res_df, <span class="st">&quot;../data/REML-p50-eigenvalues.csv&quot;</span>)</span></code></pre></div>
<p>We then plot the means of the estimated eigenvalues, including the
corresponding populatin eigenvalues as a thick red line</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cov_names <span class="ot">=</span> <span class="fu">expression</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> Sigma[A],</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> Sigma[B],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> Sigma[E]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>summ_df <span class="ot">&lt;-</span> res_df <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(p, level, method, eig_idx) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_mean =</span> <span class="fu">mean</span>(sample_eig),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_sd =</span> <span class="fu">sd</span>(sample_eig),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_eig =</span> <span class="fu">mean</span>(pop_eig)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>summ_df <span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> eig_mean, <span class="at">color =</span> <span class="fu">ordered</span>(eig_idx))) <span class="sc">+</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> level,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(cov_names[level]))) <span class="sc">+</span> </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> pop_eig), <span class="at">color =</span> doc_colours[[<span class="dv">1</span>]], <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">&quot;Number of traits (p)&quot;</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">&quot;REML eigenvalue&quot;</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">&quot;Index (i)&quot;</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">doc_seq_palette</span>(<span class="fu">length</span>(<span class="fu">unique</span>(summ_df<span class="sc">$</span>eig_idx)))</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/index.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-4-difference-between-reml-and-manova-estimates" class="section level2">
<h2>Figure 4: Difference between REML and MANOVA estimates</h2>
<p>We repeat the simulations from the previous section, but now with
parameter values described in the first paragraphs of Section 4.2.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># experiment parameters</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">70</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>max_idx <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">MANOVA =</span> manova_2way_df,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> stepreml_2way_df</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># model parameters</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>make_sigmas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> <span class="cf">function</span>(p) {sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rbinom</span>(p, <span class="dv">1</span>, <span class="fl">0.5</span>))},</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="cf">function</span>(p) {sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rbinom</span>(p, <span class="dv">1</span>, <span class="fl">0.5</span>))},</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> <span class="cf">function</span>(p) {sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)}</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>make_mu <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {<span class="fu">rep</span>(mu, p)}</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>comp_df <span class="ot">&lt;-</span> <span class="fu">repeated_sample</span>(p_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(comp_df, <span class="st">&quot;../data/REML-MANOVA-eigenvalue-comparison.csv&quot;</span>)</span></code></pre></div>
<p>We see that the largest eigenvalues of <span class="math inline">\(\hat{\Sigma}_A\)</span> are adjusted up slightly,
whereas the largest eigenvalues of <span class="math inline">\(\hat{\Sigma}_B\)</span> are adjusted down
substantially.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>comp_summary <span class="ot">&lt;-</span> comp_df <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;method&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;sample_eig&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est_diff =</span> REML <span class="sc">-</span> MANOVA) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(p, level, eig_idx) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff_mean =</span> <span class="fu">mean</span>(est_diff),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff_sd =</span> <span class="fu">sd</span>(est_diff)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>comp_summary <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> diff_mean, <span class="at">color =</span> <span class="fu">ordered</span>(eig_idx))) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> level,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(cov_names[level]))) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(lambda[<span class="st">&quot;i,R&quot;</span>] <span class="sc">-</span> lambda[<span class="st">&quot;i,M&quot;</span>]),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of traits (p)&quot;</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Index (i)&quot;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">doc_seq_palette</span>(<span class="fu">length</span>(<span class="fu">unique</span>(summ_df<span class="sc">$</span>eig_idx)))</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/e-diff.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
