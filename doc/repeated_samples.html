<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Figures for large-p simulations</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Figures for large-p simulations</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(REMLSimulationPaper)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  tidyverse,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  MASS</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load_gh</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;dpavlyshyn/halfsibdesign&quot;</span> <span class="co"># Simulate and fit balanced half-sib designs</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a global theme for all figures in the document</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code></pre></div>
<div id="figures-1-and-2-stepwise--and-pairwise-reml-estimates" class="section level1">
<h1>Figures 1 and 2: stepwise- and pairwise-REML estimates</h1>
<p>We use the parameters described in eqs. (3, 5):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># number of traits</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of sires</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># number of dams</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># number of individuals per line</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">2</span>, p) <span class="co"># Just a vector of 2s - not really important for the model</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(p))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(p))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)</span></code></pre></div>
<p>As before, we generate our half-sib data and compute the pseudo-REML
estimates, logging the eigenvalues of the corresponding estimate <span class="math inline">\(\hat{\Sigma}_A\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rhalfsib</span>(mu, A, I, B, J, E, K)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>A_reml_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>eigs_reml_est <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A_reml_est<span class="sc">$</span>S3, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span></code></pre></div>
<div id="figure-1-eigenvalue-histograms" class="section level2">
<h2>Figure 1: eigenvalue histograms</h2>
<p>We then plot the eigenvalues of <span class="math inline">\(\hat{\Sigma}_A\)</span> (in red) next to the true
eigenvalues of <span class="math inline">\(\Sigma_A\)</span> (in
blue):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>estimate_names <span class="ot">=</span> <span class="fu">expression</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="st">&quot;REML estimate&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">True =</span> <span class="st">&quot;True&quot;</span><span class="sc">~</span>Sigma[A]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>eig_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> eigs_reml_est,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">True =</span> sigma_a</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(REML, True), <span class="at">names_to =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Eigenvalue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="fu">factor</span>(Type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;REML&quot;</span>)))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(eig_df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Eigenvalue, <span class="at">fill =</span> Type)) <span class="sc">+</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>Type,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(estimate_names[<span class="fu">as.character</span>(Type)]))) <span class="sc">+</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Count&quot;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/first-REML.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-2-stepwise-reml-and-pseudo-reml-scatterplot" class="section level2">
<h2>Figure 2: Stepwise REML and Pseudo REML scatterplot</h2>
<p>Last, we investigate the strategy of computing pairwise REML
estimates for each pair of traits. We create a new estimate <span class="math inline">\(\hat{\Sigma}_{A,2}\)</span> such that the diagonal
entries <span class="math inline">\([\hat{\Sigma}_{A,2}]_{ii}\)</span>
are computed by doing a single-trait analysis on trait <span class="math inline">\(i\)</span> and the off-diagonal entries <span class="math inline">\([\hat{\Sigma}_{A,2}]_{ij}\)</span> are computed by
doing a 2-trait analysis on the traits <span class="math inline">\((i,j)\)</span>.</p>
<p>I use the pseudo-REML estimates for the 2-trait analyses, since we
need to fill in 1250 entries of a covariance matrix, and even in the
2-dimensional case, fitting a generic mixed model is too slow for this.
However, we can still compare <span class="math inline">\(\hat{\Sigma}_{A,2}\)</span> with the REML esimate
<span class="math inline">\(\hat{\Sigma}_{A,1}\)</span> to see how the
eigenvalues produced by the paiwiise procedure differ from those done by
computing the whole stepwise REML estimate at once.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>A_pairwise_est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> p, <span class="at">ncol =</span> p)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill in diagonal</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  df_sub <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, trait <span class="sc">==</span> r)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  A_sub_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df_sub)<span class="sc">$</span>S3</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  A_pairwise_est[r, r] <span class="ot">&lt;-</span> A_sub_est[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(r <span class="sc">&lt;</span> q) {</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(s <span class="cf">in</span> (r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>p) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      df_sub <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, trait <span class="sc">%in%</span> <span class="fu">c</span>(r, s))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      A_sub_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df_sub)<span class="sc">$</span>S3</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      A_pairwise_est[r, s] <span class="ot">&lt;-</span> A_sub_est[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      A_pairwise_est[s, r] <span class="ot">&lt;-</span> A_pairwise_est[r, s]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  A_pairwise_est,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;../data/pairwise-covariances.csv&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Plotting these eigenvalues, we see that the eigenvalues of <span class="math inline">\(A_2\)</span> are qualitatively similar to those of
<span class="math inline">\(A_1\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>eigs_pairwise_est <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A_pairwise_est, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span></code></pre></div>
<p>To make this comparison clearer, let <span class="math inline">\(\lambda_1 &gt; \dotsc &gt; \lambda_q\)</span> the
the eigenvalues of <span class="math inline">\(A_1\)</span> and <span class="math inline">\(\mu_1 &gt; \dotsc &gt; \mu_q\)</span> be the
eigenvalues of <span class="math inline">\(A_2\)</span>.</p>
<p>In the following figure, we plot <span class="math inline">\(\mu_i -
\lambda_i\)</span> against <span class="math inline">\(\lambda_i\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> eigs_reml_est, <span class="at">y =</span> eigs_pairwise_est <span class="sc">-</span> eigs_reml_est)) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">&quot;Eigenvalues&quot;</span><span class="sc">~</span>lambda[<span class="st">&quot;i, R&quot;</span>]<span class="sc">~</span><span class="st">&quot;of&quot;</span><span class="sc">~</span>Sigma[<span class="st">&quot;A,R&quot;</span>]),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(lambda[<span class="st">&quot;i, R&quot;</span>] <span class="sc">-</span> lambda[<span class="st">&quot;i, P&quot;</span>])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/eval-diffs.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="figures-3-and-4-repeated-samples" class="section level1">
<h1>Figures 3 and 4: repeated samples</h1>
<p>We set up a function to perform repeated samples</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>repeated_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(p_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output data frame</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fu">integer</span>(),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rep =</span> <span class="fu">integer</span>(),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fu">character</span>(),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_idx =</span> <span class="fu">integer</span>(),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">character</span>(),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_eig =</span> <span class="fu">numeric</span>(),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_eig =</span> <span class="fu">numeric</span>()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(p <span class="cf">in</span> p_vals) {</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">A</span>(p)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">B</span>(p)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    E <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">E</span>(p)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    mu_vec <span class="ot">&lt;-</span> <span class="fu">make_mu</span>(p)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(rep <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_reps) {</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> <span class="fu">rhalfsib</span>(mu_vec, A, I, B, J, E, K)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(method <span class="cf">in</span> <span class="fu">names</span>(methods)) {</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        reml_est <span class="ot">&lt;-</span> methods[[method]](df)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">#reml_est &lt;- manova_2way_df(df)</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        A_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S3, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        df_A <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> p,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_a<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> A_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        B_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S2, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>        df_B <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> p,</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_b<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> B_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>        E_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S1, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>        df_E <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> p,</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;E&quot;</span>,</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_e<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> E_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>        res_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(res_df, df_A, df_B, df_E)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res_df)</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="figure-3-bias-in-large-eigenvalues" class="section level2">
<h2>Figure 3: bias in large eigenvalues</h2>
<p>We use the parameter values specified in eq. (6):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>max_idx <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">MANOVA =</span> manova_2way_df,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> stepreml_2way_df</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># model parameters</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>make_sigmas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> <span class="cf">function</span>(p) {sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)},</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="cf">function</span>(p) {sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)},</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> <span class="cf">function</span>(p) {sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)}</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>make_mu <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {<span class="fu">rep</span>(mu, p)}</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>res_df <span class="ot">&lt;-</span> <span class="fu">repeated_sample</span>(p_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(res_df, <span class="st">&quot;../data/REML-p50-eigenvalues.csv&quot;</span>)</span></code></pre></div>
<p>We then plot the means of the estimated eigenvalues, including the
corresponding populatin eigenvalues as a thick red line</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cov_names <span class="ot">=</span> <span class="fu">expression</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> Sigma[A],</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> Sigma[B],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> Sigma[E]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>summ_df <span class="ot">&lt;-</span> res_df <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(p, level, method, eig_idx) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_mean =</span> <span class="fu">mean</span>(sample_eig),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_sd =</span> <span class="fu">sd</span>(sample_eig),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_eig =</span> <span class="fu">mean</span>(pop_eig)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>summ_df <span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> eig_mean, <span class="at">color =</span> <span class="fu">ordered</span>(eig_idx))) <span class="sc">+</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> level,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(cov_names[level]))) <span class="sc">+</span> </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> pop_eig), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">&quot;Number of traits (p)&quot;</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">&quot;REML eigenvalue&quot;</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">&quot;Index (i)&quot;</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/index.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-4-difference-between-reml-and-manova-estimates" class="section level2">
<h2>Figure 4: Difference between REML and MANOVA estimates</h2>
<p>We repeat the simulations from the previous section, but now with
parameter values described in the first paragraphs of Section 4.2.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># experiment parameters</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">70</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>max_idx <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">MANOVA =</span> manova_2way_df,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> stepreml_2way_df</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># model parameters</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>make_sigmas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> <span class="cf">function</span>(p) {sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rbinom</span>(p, <span class="dv">1</span>, <span class="fl">0.5</span>))},</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="cf">function</span>(p) {sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rbinom</span>(p, <span class="dv">1</span>, <span class="fl">0.5</span>))},</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> <span class="cf">function</span>(p) {sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(p)}</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>make_mu <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {<span class="fu">rep</span>(mu, p)}</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>comp_df <span class="ot">&lt;-</span> <span class="fu">repeated_sample</span>(p_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(comp_df, <span class="st">&quot;../data/REML-MANOVA-eigenvalue-comparison.csv&quot;</span>)</span></code></pre></div>
<p>We see that the largest eigenvalues of <span class="math inline">\(\hat{\Sigma}_A\)</span> are adjusted up slightly,
whereas the largest eigenvalues of <span class="math inline">\(\hat{\Sigma}_B\)</span> are adjusted down
substantially.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>comp_summary <span class="ot">&lt;-</span> comp_df <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;method&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;sample_eig&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est_diff =</span> REML <span class="sc">-</span> MANOVA) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(p, level, eig_idx) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff_mean =</span> <span class="fu">mean</span>(est_diff),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff_sd =</span> <span class="fu">sd</span>(est_diff)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>comp_summary <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> diff_mean, <span class="at">color =</span> <span class="fu">ordered</span>(eig_idx))) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> level,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(cov_names[level]))) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(lambda[<span class="st">&quot;i,R&quot;</span>] <span class="sc">-</span> lambda[<span class="st">&quot;i,M&quot;</span>]),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of traits (p)&quot;</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Index (i)&quot;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/e-diff.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
