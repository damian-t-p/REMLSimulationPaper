<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>repeated_samples</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">repeated_samples</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(REMLSimulationPaper)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  tidyverse,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  MASS</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load_gh</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;dpavlyshyn/halfsibdesign&quot;</span> <span class="co"># Simulate and fit balanced half-sib designs</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a global theme for all figures in the document</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code></pre></div>
<div id="feasibility-of-large-q-for-stepwise-reml" class="section level1">
<h1>Feasibility of large <span class="math inline">\(q\)</span> for
stepwise REML</h1>
<p>An important advantage of stepwise REML is that it is can easily be
run for relatively large numbers of traits. In this section, I use <span class="math inline">\(q = 50\)</span>, but <span class="math inline">\(q\)</span> can be in the thousands before the
pseudo-REML estimate takes more than a second to compute.</p>
<p>We set up the parameters on our now 50-dimensional model:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># number of traits</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of sires</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># number of dams</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># number of individuals per line</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">2</span>, q) <span class="co"># Just a vector of 2s - not really important for the model</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(q))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(q))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(q)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(q)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(q)</span></code></pre></div>
<p>As before, we generate our half-sib data and fit a pseudo-REML. To
demonstrate some more complicated begavior, we set <span class="math inline">\(\Sigma_A, \Sigma_B\)</span> to be diagonal
matrices with reandom entries. We also set <span class="math inline">\(q
= 50\)</span> to see that the software has no issues with this
dimensionality.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rhalfsib</span>(mu, A, I, B, J, E, K)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(df, &quot;data/halfsib-highdim.csv&quot;)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>A_reml_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>eigs_reml_est <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A_reml_est<span class="sc">$</span>S3, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(eigs_reml_est)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -2.512286e-16</span></span></code></pre></div>
<p>We then plot the eigenvalues of <span class="math inline">\(\hat{\Sigma}_A\)</span> (in red) next to the true
eigenvalues of <span class="math inline">\(\Sigma_A\)</span> (in
blue):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>estimate_names <span class="ot">=</span> <span class="fu">expression</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="st">&quot;REML estimate&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">True =</span> <span class="st">&quot;True&quot;</span><span class="sc">~</span>Sigma[A]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>eig_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> eigs_reml_est,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">True =</span> sigma_a</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(REML, True), <span class="at">names_to =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Eigenvalue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="fu">factor</span>(Type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;REML&quot;</span>)))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(eig_df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Eigenvalue, <span class="at">fill =</span> Type)) <span class="sc">+</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>Type,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(estimate_names[<span class="fu">as.character</span>(Type)]))) <span class="sc">+</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">expression</span>(<span class="st">&quot;Histograms of eigenvalues of&quot;</span><span class="sc">~</span>Sigma[A]<span class="sc">~</span><span class="st">&quot;and its REML estimate&quot;</span>),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Count&quot;</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAB+1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYAv8QZGT8ZGWIZP2IZP4EZYp8aGhozMzM6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNs/GRk/GT8/GWI/P2I/YoE/Yp8/gYE/gb1NTU1NTW5NTY5NbqtNjshiGRliGT9iGWJiPxliPz9iP2JiYj9iYmJiYp9igb1in71in9lmAABmADpmOgBmOjpmOmZmOpBmZjpmZmZmkJBmkLZmkNtmtpBmtrZmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SBPxmBPz+BP2KBP4GBYj+BYmKBYoGBgWKBn4GBn5+Bn9mBvdmOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQZgCQZjqQZmaQkDqQkGaQkLaQkNuQtpCQttuQ27aQ2/+fYhmfYj+fYmKfn2KfvYGfvdmf2b2f2dmrbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2Zjq2kDq2tpC2ttu225C229u22/+2/9u2//+9gT+9gWK9n4G9vYG9vb292Z+92dnIjk3I///Zn2LZn4HZvYHZ2Z/Z2b3Z2dnbkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb///kq27k///r6+v4dm3/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///9xqiyMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAYiUlEQVR4nO2di38c11mGV0qMaGjsbdI2RWkgWIkbWqCAlVBoobWbELflUsBpwSp3kigpoU5K8ZbSpjK32Ma2FocS20VWKlneP5M5c5/ds5d5Z+bbWfl5f4m1mn3OnLNnnj2Xka3tDAhpcTrzbgAhk4KgpNVBUNLqIChpdRCUtDoISlodBCWtDoKSVgdBSatTVtD+8lb4dX99dXCwceRm9szuZ7bqa1aQ73Y6KzcLR4r1zZjyhUYrnr2ulVylng7pd6J8+O3cN52gUO/Dr8TIu7+xmvXy+LiTT3xpdV+OeaU+Qad3aqnsRFcuHxtB04oPNhKDTs9cV15QT4ekTrqnCoJ2ljZDYrfbmUlQR0x8aTVfjrmliqD+Z2rKzsxaTI4gaFLx/nr4kg56pQUN4xM0OnTw3WELe0uPRv3Zf6A7s6DVgAVJ5RH04C87naVT0XATdO37z3U6D7oJbHCj21n67eCKBVet31l+e3Dj0QD8HTdGrN7oBg92up3HAnXi8kmS8r14mEmOuUkxci05b+H49x4Nzx21bn89eDapzhWKCh4UCs1S8U40lO7/3VAn5M4dVxw268Ef5EbQ96IOKdZSeHsXBF3+6/B9dLDxOZ+gw42Oetu9rKHeTJqWvxxhwYVNVUHjefB03CNBPwVx01U/mb4ONh7odo7c7Cez5W73owG09HI3frYwiablc57sJseiiTOdFnPHs3O7E7kxMK1uSNDhQpMqdi9ieJ6IjqbnTpcA4bEHnxsWdKiWuPd+0hsZQZe//6FN91of+b5H0JFG5wXN92batPhypAUXN6UFTRZOnUjQ3e7Hgu1AdyVZFXVOOebIzf31pVcG729ECq66SxYMoiEYdNqpwY2o+/LlXbLy2Ux7sOFGoHe7K2F9+fNmx92upt9ZicfY3vJWVl1R0KzQ9Ipdep6FRv7cScVZs2IkXoMWa/GvQZ0/veUfbrj3Qm9ld1RQX6OTNWixN7OmxUBScHFTXdAHPveD6JnweoR90Vva3AnHnugqxr39o+/9VbezEjH76251UCg/iPmofOZJeMXC0zs+O2/+uKshnNj7QcnwQVpdUdCs0PSKXYJLvOnphfTcScXReXO+p4Lma0l6b+ljNwfDgm71giL766c9gvoanQma782saXHtScFpl7W9qbwGdVNi57G3kx4JL+7O0mY/vLDRoBV2XDTbdOJrGUnUy5cfhFBSPvNkJ72O7kzZeYvH0xl8NSqZVlcUNCs0veKods8Wq3Du5LynB95dfKGW6NCNbrhaHJrit8K6nYMjgvoanQla6M20aSGQK7iwqX6b6d3noilrsqD7652P/u2//O/6iKBpeZfKgrqHwcXOVTdW0KkVu7yf3k3cf3YzeVQ49xRBC7XEh3Y6ofVDgroe7cXdM1bQQm+PCpo1DUHz90H/5y/ctmTsFO+oyIB0as4JmpQfDMZN8Ykww1N8/nhiR3/p1fWVfHXRMJ9NxYU15cSK3av8TLoD3vlssl8aOndu6RAvLobvg6a1JIfCPdKwoG6j1D3tE9TXaL+gWdPy48VCp6qgO52fDZY//xxc2H60y/RskiJBg+3E+891hrs0K+8yZpP0SjCUbURr0MImKXc8EXS3+9lohk+qi9ch4Z2XfKHpFQdHvxE9+yP38NXfjCf7oXOHFQfNOhXVEJ/OCRranq8l6b3oBuuwoDtLv5WsG0c2SSON7sd3NYYFTZoWA0nBkle5RanpNlN0/2fMbaboKnZisNilWfkwWfnMk538pix3m6l4PBY0OJ9rYVZd+GSIhjeBcoWmVnzwjejRDXf39iM3e+k7pnDuqOKshgiJO2SolqT3+rlbQuGMHS9L4lV0+tTqSA/ke3tU0Kxp8eUonGYhU8+Nercr3X/O3XPZLdyo/3y6UItuhL/Si3cB2RSflo+Sls8NZO7YA6fyN+o/HxYvHo8XgP1oFEuri578727nsfc28oVmqLjXyTzpB1c7uVszdO6o4mBx+OAPC2vQsEOKtSS9F4h0ekTQ6J6WT1BPo93J3xvdJKVNy12OB7KfRixgmv3bTKM/EG33eccmHJoWeaZc2DQl6G73p4LR0Xefu53nnVbtR9wPABZ/y7F4aUrQocVX6887Jf3wR6iL/BOZRU1jU/zQEq/1551c6Z+HfwklvRVKzMLfqCetDoKSVgdBSauDoKTVQVDS6iAoaXUQlLQ6CEpaHQQlrQ6CklanpKDHSMnQcWJEQbdJqRyj47QgqE0QVAyC2gRBxSCoTRBUDILaBEHFIKhNEFQMgtoEQcUgqE0QVMziCnr9S0ddPvjOvBsyUxBUzOIKGuTqE+fHPfO4k/ehcU/bZz6Cpt0QPfjA2auPPxwcfu2h8+O6LjjufWp8VzecxRf06s996qE3ggfum2vPJFJefDIYY795fp6tK2ROgoZaXfzgO4lfVz/+8+9sX/ulMRZujxcRQZVEgj5+Mnzg/n/t+PbFh6PnXj8+16YNZ56C5kbFq0/8ytntq58uCBq/q6+4odY9Dt7t17/81aNHjwdHjkej8MmQyd7+hjkEgsZyBv9f+8Wz29c+eT587vqXz861bUNpywj6xN+f3P7XPyoIGr2rXb8FXyKZr38pePT4w0mfxobn3v52OVyCPhMutKInr5yca9uGMs81aLCPTB5cfeKNJ69/5Y28oPG72n3ZTkZb9+52/8cHg6eH3v52OVyC5rrvv/4k/HL9K+0YSOc3gl5x79hsBP3WH/7nrxZ2Qsm7OnD4A2d9gr7m5v7ht79ZDoegriMvPhROQlei+05Xfy3449/+YfvKp9uxFp3jFO86JhP0/OtfPV4UNHtXXwnXAkVBrz1zMrbWfvR0ORyCbl88evQXPhnu4qO3ePhud0v6b37r91pxo3SOgoYLykzQYES9OrwGDcx0b2yfoOHk9PGz8Rr0ivlt54UWdHqu/fIf/34r1qJz3cU/fjxagx49Gfnn/gsPhFue+F0dzuSBzdEuPpvig/f+z3zqZHD8fPr2t8whF/Tir//Hvz8570a48JMkMYdb0Ot/cH57+/U2bJMQVMzhFrQ9QVAxCGoTBBWDoDZBUDEIahMEFYOgNkFQMQhqEwQVowpKSoaOEyMKOnrox9NLtQkxbkwqaEOVHNq+RVAbBEFFBEFtEAQVEQS1QRBURBDUBkFQEUFQGwRBRQRBbRAEFREEtUEQVEQQ1AZBUBFBUBsEQUUEQW0QBBURBLVBEFREENQGQVARQVAbBEFFBEFtEAQVEQS1QfyC/nSSypUc2r5FUBsEQUUEQW0QBBURBLVBEFREENQGQVARQVAbBEFFBEFtEAQVEQS1QRBURBDUBkFQEUFQGwRBRQRBbRAEFREEtUEQVEQQ1AZBUBFBUBsEQUUEQW0QBBURBLVBEFREENQGQVARQVAbBEFFBEFtEAQVEQS1QRBURBDUBkFQEUFQGwRBRQRBbRAEFREEtUEQVEQQ1AZBUBFBUBsEQUUEQW0QBBURVdAfk1I55u24VNA5tWoBwghqgzCCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiINCfp/aZRGWSAI2hyCoDUgCNocgqA1IAjaHIKgNSAI2hyCoDUgCNocgqA1IAjaHIKgNSAI2hyCoDUgCNocgqA1IAjaHIKgNSAI2hyCoDUgCNocgqA1IAjaHIKgNSAI2hyCoDUgCNocgqA1IAjaHGIu6N4LlweDW2tra09fjo8gaEkEQUVkFkHvhGJeOpc7hKAlEQQVkRkEvfTUd4IR9N5bF3LHELQkgqAiMvMUf/elYIoPB9FjLlM+AjQT1OQTR9ufVNDC0VTQObVqATKzoHvPX8iNooygJRFGUBGZfZPkkq5DEbQkgqAigqA2CIKKyMyC3jlxe3Dv29xmEhEEFZFS90GfSjfyCFoSQVAR4SdJNgiCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiKqoFM+YTET1OQDHdufY96OSwWdU6sWIIygNggjqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCJiJ6hX2clnaRJB0OYQBK0BQdDmEAStAUHQ5hAErQFB0OYQBK0BQdDmEAStAUHQ5hAErQFB0OaQpgXdXz/tvuwsb40ti6AlEQQVEQS1QRBUREYF7XeSrIwvi6AlEQQVkQkj6KQgaEkEQUWETZINgqAi4hV0txtO8axB60MQVER8gh5sTFh9RkHQkgiCishMa9C9Fy4PBndfWjtxOzmCoCURBBUR/whaFPTO2tOXB/fePDe49YnkEIKWRBBURLxr0OId0EtPfScYQe9+/XI0kg7yxcbViKBDCIKKiH+K7xQ3SU7MvRdvD+5+7YIr4jLlExYzQUcPNfvZji1NKmjhaCronFq1AJnpNpMT9M6JRNC81+PeEoygQwgjqIjMLGg2guaLjasRQYcQBBWRmad41qCVEAQVkfEj6P6zm8lDJ+a9N8+wi9cRBBWRCVP8zpGb8SPug1ZGEFREJgnKjzrrQxBURCYI2ktH0NEgaEkEQUVkwiZpaXN8WQQtiSCoiPDX7WwQBBURBLVBEFRE/IKG/+xjdUJZBC2JIKiIeAXtu/37/voEQxG0JIKgIsK/6rRBEFREENQGQVARYYq3QRBURNgk2SAIKiLcZrJBEFREENQGQVAR8Qga7pEONib8JB5BSyMIKiKjgu52o8Vnb8ImHkHLIggqIqOC9laGH3iCoCURBBWREUGz39rAfVAE1RAErQFB0OaQRgU92Ejuf/b5C8v1IQgqIqNr0H48cGameoKgJREEFRHPbaZe+Ffp99cn3WdC0JIIgoqI70Z9+OtBJ/2DDwQtjSCoiPCTJBsEQUUEQW0QBBURBLVBEFREENQGQVARQVAbBEFFBEFtEAQVEQS1QRBURBDUBkFQEUFQGwRBRQRBbRAEFREEtUEQVEQQ1AZBUBFBUBsEQUUEQW0QBBURBLVBEFREENQGQVARQVAbBEFFRBV0ykeAZoKOHmr2w0dbmmPejksFnVOrFiCMoDYII6iIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiKNCzqa6Y2anPZ14gwIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIFMEnWxq+16OXU0IaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCIyu6C31tbWnr4cf4OgJREEFZHZBb10LvcNgpZEEFREZhb03lsXct8haEkEQUVkZkHvvhRM8eEgesxlyicsThLU5CMe25ZU0MLRUUHn1Lz2ZmZB956/kBtFGUFLIoygIlJuF5+uQxG0JIKgIoKgNgiCisjMgt45cXtw79vcZhIRBBWRUvdBn0o38ghaEkFQEeEnSTYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCJSr6CTvETQ/Ncoo4J60saXY1cTgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAigqA2CIKKCILaIAgqIrUIOpOXszm7kJ04A1JB0Jypw8WaaWtlBEFrQBC0OQRBa0AQtDkEQWtAELQ5BEFrQBC0OQRBa0AQtDkEQWtAELQ5BEFrQBC0OQRBa0AQtDmkDYIWPvCzsqBz+qBSwxzzdlw5QUeLWb+KOYQR1AZhBBURBLVBEFREENQGQVARQVAbBEFFBEFtEAQVEQS1QRBURBDUBkFQEUFQGwRBRaStgnqeKvvSqjOtFzT3HIIWgqAlEQQVEQS1QRBURBDUBkFQEUFQGwRBRQRBbRAEFREEtUEQVEQQ1AZBUBFBUBsEQUUEQW0QBBURBLVBEFREENQGQVARQVAbBEFFBEFtEAQVEQS1QRBURBDUBkFQEUFQGwRBRaRlgk5yt+xLq860TFAxWUMmqF7y5YyeydMrE6GRmjztdX8gqA2CoF7E1xdFBEFtEAT1Ir6+KCIIaoMgqBfx9UURQVAbBEG9iK8vigiC2iAI6kV8fVFEENQGQVAv4uuLIoKgNgiCehFfXxQRBLVBENSL+PqiiCCoDYKgXsTXF0UEQW0QBPUivr4oIghqgyCoF/H1RRFBUBsEQb2Iry+KCILaIAjqRXx9UUQQ1AZBUC/i64siMrugd19aO3E7+QZBSyII6kV8fVFEZhb03pvnBrc+kXyHoCURBPUivr4oIjMLevfrlwd7L1yOv0PQkgiCehFfXxSRmQXde/H24O7XLrgiLvP+CMdFSyrovBuyaJlZ0DsnEkHzXk96S7QbacUIWl8lh7ZvhRE0X6yZRlkgCNocMhdBJ61B626UBYKgzSFzEfTem2fG7uLrbpQFgqDNIXMRdNJ90LobZYEgaHPIfAQtBEFLIggqIghqgyCoiCCoDYKgIoKgNgiCigiC2iAIKiIIaoMgqIggqA2CoCKCoDYIgooIgtogCCoiCGqDIKiIIKgNgqAiogpKSoaOE6MJ6nO28hnadhabxixSW21PUzgLgjZ2GgSt4ywI2thpELSOs1QXlJAGg6Ck1UFQ0uogKGl1EJS0OhUFLfyLOjl7X1xbO1f5LNHvkarhJGtPXZiOTUnwkp6+PP7pevrtfui4aoIWf7OYGvd7Ifaer/7aBrfquFqXzoW/TaVa3Eu6Nf4s9fTbfdFx1QQt/lYHNXfcpbpUvYv2fvdPq5/EvaTqCX8fy/gz1dNv90XHVRO0+HtxqqSGs9x7659qmKn2XvzHGmaqKSNoff126DuumqDF3yxWIe73l1TNrTN1LKX2vngu9KdiJi8ya+u3w99x7RhB7750pvI5grbU0s+1vCS3MrwzfpdU2wh6+DuuDWvQ8M1XObfWXM5UPc3dP6ujn6cMkTX12/3QcVV38Wdq2I3W0s0utdwtuVTHTDVlBK2n3+6LjmvDfdDoLVzLnbgaThK8pEl3MGfMnbWJO4Z67oPeDx3HT5JIq4OgpNVBUNLqIChpdRCUtDoISlodBK2Wg41OmOWt3Q9tzlhmdpIgaMUcbKyWLoOgJYKg1YKgDQdBqyUT1Gm3v95ZevmRrXDiX94KDr3c7XROR0w/WAUE33VWHRk66v6ISTIuCFotBUH311cDR5e3DjZWAiGP3NztHrnpxAweOnB//XTkaSZoQs7zJbQ7CFotySYpHBd33FgYGBh+DXTc7Z4eJONl8P9PnIfRt4mgCTnvl9HeIGi1FEbQcCjcfWSrH0ubjZOr0TC5ExxdyguakHN8BS0PglaLX9B4zk5XmjtH3ttws//S5tAIyuw+LQhaLQVBwwk7+GMnEDE+FG+ennVbp51wEC2MoAlJxgVBq2XMJilQMTIxtrTXWQndHOx2w8OOPNhY2kzI+b2AtgdBqyXZJEU2uttMf7Mc3WaKpvNY0J2O2wf1gqOvBnsnt2fqdjpfeHYzIcm4IGjd2WFZWWcQtMa4uTq8s0lqC4LWGXfXCD9rDYKSVgdBSauDoKTVQVDS6iAoaXUQlLQ6CEpanf8HCvkbLPtDMeMAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/first-REML.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
<div id="pairwise-reml" class="section level2">
<h2>Pairwise REML</h2>
<p>Last, we investigate the strategy of computing pairwise REML
estimates for each pair of traits. We create a new estimate <span class="math inline">\(\hat{\Sigma}_{A,2}\)</span> such that the diagonal
entries <span class="math inline">\([\hat{\Sigma}_{A,2}]_{ii}\)</span>
are computed by doing a single-trait analysis on trait <span class="math inline">\(i\)</span> and the off-diagonal entries <span class="math inline">\([\hat{\Sigma}_{A,2}]_{ij}\)</span> are computed by
doing a 2-trait analysis on the traits <span class="math inline">\((i,j)\)</span>.</p>
<p>I use the pseudo-REML estimates for the 2-trait analyses, since we
need to fill in 1250 entries of a covariance matrix, and even in the
2-dimensional case, fitting a generic mixed model is too slow for this.
However, we can still compare <span class="math inline">\(\hat{\Sigma}_{A,2}\)</span> with the REML esimate
<span class="math inline">\(\hat{\Sigma}_{A,1}\)</span> to see how the
eigenvalues produced by the paiwiise procedure differ from those done by
computing the whole stepwise REML estimate at once.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>A_pairwise_est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> q, <span class="at">ncol =</span> q)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>q) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill in diagonal</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  df_sub <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, trait <span class="sc">==</span> r)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  A_sub_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df_sub)<span class="sc">$</span>S3</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  A_pairwise_est[r, r] <span class="ot">&lt;-</span> A_sub_est[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(r <span class="sc">&lt;</span> q) {</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(s <span class="cf">in</span> (r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>q) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      df_sub <span class="ot">&lt;-</span> <span class="fu">filter</span>(df, trait <span class="sc">%in%</span> <span class="fu">c</span>(r, s))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      A_sub_est <span class="ot">&lt;-</span> <span class="fu">stepreml_2way_df</span>(df_sub)<span class="sc">$</span>S3</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      A_pairwise_est[r, s] <span class="ot">&lt;-</span> A_sub_est[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      A_pairwise_est[s, r] <span class="ot">&lt;-</span> A_pairwise_est[r, s]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>A_pairwise_est <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;../data/pairwise-covariances.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unname</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  A_pairwise_est,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;../data/pairwise-covariances.csv&quot;</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Plotting these eigenvalues, we see that the eigenvalues of <span class="math inline">\(A_2\)</span> are qualitatively similar to those of
<span class="math inline">\(A_1\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>eigs_pairwise_est <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A_pairwise_est, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span></code></pre></div>
<p>To make this comparison clearer, let <span class="math inline">\(\lambda_1 &gt; \dotsc &gt; \lambda_q\)</span> the
the eigenvalues of <span class="math inline">\(A_1\)</span> and <span class="math inline">\(\mu_1 &gt; \dotsc &gt; \mu_q\)</span> be the
eigenvalues of <span class="math inline">\(A_2\)</span>.</p>
<p>In the following figure, we plot <span class="math inline">\(\mu_i -
\lambda_i\)</span> against <span class="math inline">\(\lambda_i\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> eigs_reml_est, <span class="at">y =</span> eigs_pairwise_est <span class="sc">-</span> eigs_reml_est)) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">expression</span>(<span class="st">&quot;Comparison of eigenvalues of&quot;</span><span class="sc">~</span>Sigma[<span class="st">&quot;A,R&quot;</span>]<span class="sc">~</span><span class="st">&quot;and&quot;</span><span class="sc">~</span>Sigma[<span class="st">&quot;A,P&quot;</span>]),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">&quot;Eigenvalues&quot;</span><span class="sc">~</span>lambda[<span class="st">&quot;i, R&quot;</span>]<span class="sc">~</span><span class="st">&quot;of&quot;</span><span class="sc">~</span>Sigma[<span class="st">&quot;A,R&quot;</span>]),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(lambda[<span class="st">&quot;i, R&quot;</span>] <span class="sc">-</span> lambda[<span class="st">&quot;i, P&quot;</span>])</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/eval-diffs.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="repeated-sampling" class="section level1">
<h1>Repeated sampling</h1>
<p>With the improved algorithm for computing REML esimates of <span class="math inline">\(\Sigma_A, \Sigma_B, \Sigma_E\)</span> in the
balanced case, investigation of large eigenvalues of these matrices
throughrepeated sampling becomes much more tractable.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>repeated_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(q_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>) {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output data frame</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">integer</span>(),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rep =</span> <span class="fu">integer</span>(),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fu">character</span>(),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_idx =</span> <span class="fu">integer</span>(),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">character</span>(),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_eig =</span> <span class="fu">numeric</span>(),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_eig =</span> <span class="fu">numeric</span>()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> q_vals) {</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">A</span>(q)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">B</span>(q)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    E <span class="ot">&lt;-</span> make_sigmas<span class="sc">$</span><span class="fu">E</span>(q)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    mu_vec <span class="ot">&lt;-</span> <span class="fu">make_mu</span>(q)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(rep <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_reps) {</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> <span class="fu">rhalfsib</span>(mu_vec, A, I, B, J, E, K)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(method <span class="cf">in</span> <span class="fu">names</span>(methods)) {</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        reml_est <span class="ot">&lt;-</span> methods[[method]](df)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">#reml_est &lt;- manova_2way_df(df)</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        A_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S3, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        df_A <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">q =</span> q,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_a<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> A_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        B_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S2, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        df_B <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">q =</span> q,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_b<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> B_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>        E_eigs <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reml_est<span class="sc">$</span>S1, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>        df_E <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">q =</span> q,</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">rep =</span> rep,</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">level =</span> <span class="st">&quot;E&quot;</span>,</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">eig_idx =</span> <span class="dv">1</span><span class="sc">:</span>max_idx,</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> method,</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">pop_eig =</span> sigma_e<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_eig =</span> E_eigs[<span class="dv">1</span><span class="sc">:</span>max_idx]</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>        res_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(res_df, df_A, df_B, df_E)</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res_df)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="distribution-of-large-eigenvalues" class="section level2">
<h2>Distribution of large eigenvalues</h2>
<p>First, we investigate the largest eigenvalues of REML estimates with
increasing numbers of traits.</p>
<p>In this example, we simulate half-sibling designs with <span class="math inline">\(\Sigma_A = I, \Sigma_B = 2I, \Sigma_E = I, \mu =
(2, \dotsc, 2)\)</span> with <span class="math inline">\(I = 100, J= 3,
K = 5\)</span>. We perform 50 such simulations for each of <span class="math inline">\(q = 10, 20, \dotsc, 100\)</span> and plot the
results.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># experiment parameters</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>q_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>max_idx <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#MANOVA = manova_2way_df,</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> stepreml_2way_df</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># model parameters</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>make_sigmas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> <span class="cf">function</span>(q) {sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(q)},</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="cf">function</span>(q) {sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(q)},</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> <span class="cf">function</span>(q) {sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(q)}</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>make_mu <span class="ot">&lt;-</span> <span class="cf">function</span>(q) {<span class="fu">rep</span>(mu, q)}</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>res_df <span class="ot">&lt;-</span> <span class="fu">repeated_sample</span>(q_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>res_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;../data/REML-p50-eigenvalues.csv&quot;</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;i&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;d&quot;</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(res_df, <span class="st">&quot;../data/REML-p50-eigenvalues.csv&quot;</span>)</span></code></pre></div>
<p>In the following plot, we show the means of the top 5 eigenvalues of
the REML estimates for each of <span class="math inline">\(\Sigma_A,
\Sigma_B,\Sigma_E\)</span>. Additionally, the corresponding population
eigenvalues (1, 2, 1 respectively) are shown in a thick red line.</p>
<p>We see that as <span class="math inline">\(q\)</span> increases, the
largest eigenvalues become increasingly biased.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cov_names <span class="ot">=</span> <span class="fu">expression</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> Sigma[A],</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> Sigma[B],</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> Sigma[E]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>summ_df <span class="ot">&lt;-</span> res_df <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(q, level, method, eig_idx) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_mean =</span> <span class="fu">mean</span>(sample_eig),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">eig_sd =</span> <span class="fu">sd</span>(sample_eig),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_eig =</span> <span class="fu">mean</span>(pop_eig)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>summ_df <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> q, <span class="at">y =</span> eig_mean, <span class="at">color =</span> <span class="fu">ordered</span>(eig_idx))) <span class="sc">+</span> </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> level,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(cov_names[level]))) <span class="sc">+</span> </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> pop_eig), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">&quot;Largest eigenvalues of REML fit&quot;</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Mean of 50 replicates of top-5 eigenvalues&quot;</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">&quot;Number of traits (p)&quot;</span>,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">&quot;REML eigenvalue&quot;</span>,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">&quot;Index (i)&quot;</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/index.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
<div id="difference-between-reml-and-manova-estimates" class="section level2">
<h2>Difference between REML and MANOVA estimates</h2>
<p>Another question of interest is how close the large eigenvalues of
the REML estimates are to the corresponding MANOVA eigenvalues. In the
previous example, the eigenvalues of <span class="math inline">\(\Sigma_A, \Sigma_B, \Sigma_E\)</span> were large
enough that the REML estimates coincided with the MANOVA estimates.</p>
<p>To see a more pathological example, we repeat the simulations of the
previous sub-section, but now with half of the diagonals of <span class="math inline">\(\Sigma_A\)</span> and <span class="math inline">\(\Sigma_B\)</span> set to zero at random. Now, the
smallest eigenvalues of the MANOVA estimates of <span class="math inline">\(\Sigma_A\)</span> and <span class="math inline">\(\Sigma_B\)</span> are negative and so must me
corrected.</p>
<p>To examine the discrepancies between the two estimates, we plot the
mean and standard deviation of the differnces <span class="math inline">\(\lambda_i(\hat{\Sigma}_{k, \text{REML}}) -
\lambda_i(\hat{\Sigma}_{k, \text{MANOVA}})\)</span> for <span class="math inline">\(i = 1, \dotsc, 5, k = A, B, E\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># experiment parameters</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>q_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">70</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>max_idx <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">MANOVA =</span> manova_2way_df,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> stepreml_2way_df</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># model parameters</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>sigma_a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>sigma_b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>make_sigmas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> <span class="cf">function</span>(q) {sigma_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rbinom</span>(q, <span class="dv">1</span>, <span class="fl">0.5</span>))},</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="cf">function</span>(q) {sigma_b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rbinom</span>(q, <span class="dv">1</span>, <span class="fl">0.5</span>))},</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> <span class="cf">function</span>(q) {sigma_e<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">diag</span>(q)}</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>make_mu <span class="ot">&lt;-</span> <span class="cf">function</span>(q) {<span class="fu">rep</span>(mu, q)}</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>comp_df <span class="ot">&lt;-</span> <span class="fu">repeated_sample</span>(q_vals, I, J, K, n_reps, methods, make_sigmas, make_mu, <span class="at">max_idx=</span><span class="dv">5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>comp_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;../data/REML-MANOVA-eigenvalue-comparison.csv&quot;</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;i&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;d&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(comp_df, <span class="st">&quot;../data/REML-MANOVA-eigenvalue-comparison.csv&quot;</span>)</span></code></pre></div>
<p>We see that the largest eigenvalues of <span class="math inline">\(\hat{\Sigma}_A\)</span> are adjusted up slightly,
whereas the largest eigenvalues of <span class="math inline">\(\hat{\Sigma}_B\)</span> are adjusted down
substantially.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>comp_summary <span class="ot">&lt;-</span> comp_df <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;method&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;sample_eig&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est_diff =</span> REML <span class="sc">-</span> MANOVA) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(q, level, eig_idx) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff_mean =</span> <span class="fu">mean</span>(est_diff),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff_sd =</span> <span class="fu">sd</span>(est_diff)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>comp_summary <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> q, <span class="at">y =</span> diff_mean, <span class="at">color =</span> <span class="fu">ordered</span>(eig_idx))) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> level,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">label_bquote</span>(.(cov_names[level]))) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Difference between REML and MANOVA eigenvalues&quot;</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Mean difference of 50 replicates of top-5 eigenvalues&quot;</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(lambda[<span class="st">&quot;i,R&quot;</span>] <span class="sc">-</span> lambda[<span class="st">&quot;i,M&quot;</span>]),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of traits (p)&quot;</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Index (i)&quot;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;../figs/e-diff.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
